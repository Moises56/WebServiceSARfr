<div class="container text-center">
    <div class="row justify-content-center align-items-center" style="height: 55vh;">
        <div class="col-md-6">

          @if(errorMessage1){
            <!-- <div class="alert alert-danger  text-center alert-dismissible fade show" role="alert">
              <strong>Error: </strong> {{errorMessage1}}
            </div>   -->

            <div class="alert alert-warning alert-dismissible fade show" role="alert">
              <strong>Holy Error: </strong>{{errorMessage1}}
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"  (closed)="close()"></button>
            </div>

            <!-- @for (alert of alerts; track alert) {
              <ngb-alert [type]="alert.type" (closed)="close(alert)">{{ errorMessage1 }}</ngb-alert>
            } -->
          }



            <!-- <h4 class="text-center mb-4">Consulta Venta Brutas</h4> -->
            <img src="/assets/logos/CONSULTAVENTASBRUTAS.png" alt="CONSULTA VENTAS BRUTAS" class="img-fluid mx-auto mb-3" style="width: 60%; padding-top: 30px;" />

            <form [formGroup]="formRtn" (ngSubmit)="sendData()">
                <div class="cart1 text-center">
                    <div class="card mb-3" style="max-width: 270px; margin-left: auto; margin-right: auto;">
                        <div class="row g-0">
                            <div class="col-md-12">
                                <div class="card-body">
                                    <!-- Identidad -->
                                    <div class="input-group mb-3">
                                        <span class="input-group-text" id="basic-addon2"><b>RTN</b></span>
                                        <input type="text" class="form-control" placeholder="Ingrese RTN"
                                            aria-label="Número de Identidad" aria-describedby="basic-addon2"
                                            formControlName="Rtn">
                                    </div>

                                    <!-- <div class="input-group mb-3">
                                        <span class="input-group-text">PeriodoDesde</span>
                                        <input type="text" class="form-control" placeholder="202201" aria-label="202201" formControlName="PeriodoDesde">
                                        <input type="text" class="form-control" placeholder="202201" aria-label="202201">
                                        <span class="input-group-text">Periodo Hasta</span>
                                        <input type="text" class="form-control" placeholder="202203" aria-label="202203" formControlName="PeriodoHasta">
                                        <input type="text" class="form-control" placeholder="202203" aria-label="202203">
                                    </div> --> 

                                    <div class="input-group mb-3">
                                      <label class="input-group-text" for="inputGroupSelect01" ><b>AÑO</b></label>
                                      <!-- <select class="form-select" id="inputGroupSelect01" formControlName="Anio" (change)="onSelecAnio($event)"> -->
                                      <select class="form-select" id="inputGroupSelect01" formControlName="Anio">
                                        <option selected>Seleccione una opcion...</option>
                                        <option value="2018">2018</option>
                                        <option value="2019">2019</option>
                                        <option value="2020">2020</option>
                                        <option value="2021">2021</option>
                                        <option value="2022">2022</option>
                                        <option value="2023">2023</option>
                                        <option value="2024">2024</option>
                                      </select>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <button class="btn btn-success w-100" (click)="saveSumaVVB()"><b>Buscar</b></button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

@if (isLoadding) {
    <!-- <div class="container">
      <div class="row justify-content-center align-items-center">
        <div class="d-flex justify-content-center">
          <div class="spinner-border text-info" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>
      </div>
    </div> -->

    <div class="loader">
      <div class="outer"></div>
      <div class="middle"></div>
      <div class="inner"></div>
    </div>
    
}

<div class="container">
  <div class="row">

    <div [ngClass]="{'visible':regionVisible == 'error', 'no-visible':regionVisible != 'error'}">
      @if (errorMessage) {
        <div class="alert alert-danger" role="alert">
          {{errorMessage}}
        </div>
      }
    </div>

    <div [ngClass]="{'visible':regionVisible == 'data', 'no-visible':regionVisible != 'data'}">
        @if(ventasData){
          <div class="col-12">
              <!-- mostrar la suma de todas las ventas -->
              <!-- <div class="text-center">
                <span class="badge bg-primary text-wrap">Total Volumen de Ventas Brutas: {{ventasData.data.ventasBrutas.exportacionesFCA + ventasData.data.ventasBrutas.exportacionesFCA15 + ventasData.data.ventasBrutas.exportacionesFCA18 + ventasData.data.ventasBrutas.exportacionesCA + ventasData.data.ventasBrutas.exportacionesCA15 + ventasData.data.ventasBrutas.exportacionesCA18 + ventasData.data.ventasBrutas.transferenciaServiciosFyduca15 + ventasData.data.ventasBrutas.transferenciaServiciosFyduca18 + ventasData.data.ventasBrutas.transferenciaBienesFyduca15 + ventasData.data.ventasBrutas.transferenciaBienesFyduca18 + ventasData.data.ventasBrutas.ventasExentasMI18 + ventasData.data.ventasBrutas.ventasExentasMI + ventasData.data.ventasBrutas.ventasExentasMI15 + ventasData.data.ventasBrutas.ventasExentasExportaciones + ventasData.data.ventasBrutas.ventasExentasExportacionesFCA + ventasData.data.ventasBrutas.ventasExentasExportacionesCA + ventasData.data.ventasBrutas.ventasExoneradasOCE15 + ventasData.data.ventasBrutas.ventasExoneradasOCE18 + ventasData.data.ventasBrutas.ventasExoneradasPN + ventasData.data.ventasBrutas.ventasNetasMI12 + ventasData.data.ventasBrutas.ventasNetasMI15 + ventasData.data.ventasBrutas.ventasNetasMI18 }} </span>
              </div> -->

              <!-- SUMA Volumen Total de venta por año -->
              <table class="table table-striped table-hover">
                <thead>
                  <tr>
                    <!-- <th scope="col">#</th> -->
                    <th scope="col">AÑO</th>
                    <th scope="col">#RTN</th>
                    <!-- <th scope="col">Solicitante</th> -->
                    <th scope="col">EMPRESA</th>
                    <!-- <th scope="col">Actividad</th> -->
                    <th scope="col">AMDC</th>
                    <th scope="col">SAR</th>
                    <!-- <th scope="col">Acciones</th> -->
                  </tr>
                </thead>
                <tbody>
                  <!--  (click)="verSolicitud(sol._id)" -->

                  @if (sumasVentasBrutas) {
                    @for (suma of sumasVentasBrutas; track suma.id) {
                    <tr class="fila-solicitud">
                      <!-- <th scope="row">{{ i + 1 }}</th> -->

                          <td>{{suma.anio}}</td>
                          <td>{{RTNI}}</td>
                          <!-- <td>{{ sol.Solicitante }}</td> -->
                          <td>{{suma.nombreEmpresa}}</td>
                          <!-- <td>{{ sol.Actividad }}</td> -->
                          <td>{{suma.sumaAMDC}} </td>
                          <td>{{suma.sumaSar}} </td>

                      <!-- <td> <span class="badge bg-primary text-wrap">{{ventasData.data.ventasBrutas.exportacionesFCA + ventasData.data.ventasBrutas.exportacionesFCA15 + ventasData.data.ventasBrutas.exportacionesFCA18 + ventasData.data.ventasBrutas.exportacionesCA + ventasData.data.ventasBrutas.exportacionesCA15 + ventasData.data.ventasBrutas.exportacionesCA18 + ventasData.data.ventasBrutas.transferenciaServiciosFyduca15 + ventasData.data.ventasBrutas.transferenciaServiciosFyduca18 + ventasData.data.ventasBrutas.transferenciaBienesFyduca15 + ventasData.data.ventasBrutas.transferenciaBienesFyduca18 + ventasData.data.ventasBrutas.ventasExentasMI18 + ventasData.data.ventasBrutas.ventasExentasMI + ventasData.data.ventasBrutas.ventasExentasMI15 + ventasData.data.ventasBrutas.ventasExentasExportaciones + ventasData.data.ventasBrutas.ventasExentasExportacionesFCA + ventasData.data.ventasBrutas.ventasExentasExportacionesCA + ventasData.data.ventasBrutas.ventasExoneradasOCE15 + ventasData.data.ventasBrutas.ventasExoneradasOCE18 + ventasData.data.ventasBrutas.ventasExoneradasPN + ventasData.data.ventasBrutas.ventasNetasMI12 + ventasData.data.ventasBrutas.ventasNetasMI15 + ventasData.data.ventasBrutas.ventasNetasMI18 }} </span></td> -->
                      <!-- <td>
                        <button type="button" class="btn btn-primary" >Guardar Consulta</button>
                      </td> -->
                    </tr>
                  }
                }
                </tbody>
              </table>

              <!-- agregar boton para ver la consulta  -->
              <!-- <div class="text-center">
                <button type="button" class="btn btn-success w-50" (click)="saveConsulta()">
                  Guardar Consulta
                </button>
              </div> -->

              <div [ngClass]="{'visible':regionVisible == 'verInfoSar', 'no-visible':regionVisible != 'verInfoSar'}">
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>EXPORTACIONES (FUERA REGION CENTROAMERICANA) </b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.exportacionesFCA }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>EXPORTACIONES (FUERA REGION CENTROAMERICANA) AL 15% </b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.exportacionesFCA15 }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>EXPORTACIONES (FUERA REGION CENTROAMERICANA) AL 18%  exportacionesFCA18</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.exportacionesFCA18 }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>EXPORTACIONES (REGION CENTROAMERICANA)</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.exportacionesCA }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>EXPORTACIONES (REGION CENTROAMERICANA) AL 15%</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.exportacionesCA15 }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>EXPORTACIONES (REGION CENTROAMERICANA) AL 18%</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.exportacionesCA18 }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>TRANSFERENCIA DE SERVICIOS FYDUCA AL 15%</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.transferenciaServiciosFyduca15 }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>TRANSFERENCIA DE SERVICIOS FYDUCA AL 18%</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.transferenciaServiciosFyduca18 }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>TRANSFERENCIAS DE BIENES FYDUCA AL 15%</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.transferenciaBienesFyduca15 }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>TRANSFERENCIAS DE BIENES FYDUCA AL 18%</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.transferenciaBienesFyduca18 }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>VENTAS EXENTAS EN EL MERCADO INTERNO (18%)</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.ventasExentasMI18 }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>VENTAS EXENTAS EN MERCADO INTERNO</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.ventasExentasMI }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>VENTAS EXENTAS EN MERCADO INTERNO AL 15%</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.ventasExentasMI15 }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>VENTAS EXENTAS POR EXPORTACIONES</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.ventasExentasExportaciones }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>VENTAS EXENTAS POR EXPORTACIONES (FUERA REGION CENTROAMERICANA)</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.ventasExentasExportacionesFCA }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>VENTAS EXENTAS POR EXPORTACIONES (REGION CENTROAMERICANA)</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.ventasExentasExportacionesCA }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>Ventas Exoneradas con OCE AL 15%</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.ventasExoneradasOCE15 }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>VENTAS EXONERADAS CON OCE AL 18%</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.ventasExoneradasOCE18 }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>VENTAS EXONERADAS PERSONA NATURAL (DECRETO 119-2016)</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.ventasExoneradasPN }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>VENTAS NETAS MERCADO INTERNO GRAVADAS AL 12% </b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.ventasNetasMI12 }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>VENTAS NETAS MERCADO INTERNO GRAVADAS AL 15%</b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.ventasNetasMI15 }}</li>
                </ul>
                <ul class="list-group list-group-horizontal">
                  <li class="list-group-item list-group-item-secondary apo-p"><b>VENTAS NETAS MERCADO INTERNO GRAVADAS AL 18% </b></li>
                  <li class="list-group-item apo-p">{{ ventasData.data.ventasBrutas.ventasNetasMI18 }}</li>
                </ul>
              </div>
            
            </div>
          }
    </div>

   

  </div>

</div>





